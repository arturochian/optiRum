\documentclass[
%paper=128mm:96mm, % The same paper size as used in the beamer class
fontsize=12pt, % Font size
pagesize, % Write page size to dvi or pdf
parskip=full-, % Paragraphs separated by half a line
]{scrartcl} % KOMA script (article)

\usepackage{savetrees}
\setlength\parindent{0pt}

%----------------------------------

% Colors
\usepackage{xcolor}   % Required for custom colors
% Define a few colors for making text stand out within the presentation
\definecolor{optiplum}{RGB}{129,61,114}
\newcommand*{\optiplum}[1]{\textcolor{optiplum}{#1}}

\usepackage{hyperref} % turn all your internal references into hyperlinks
\hypersetup{
     colorlinks=true,    % false: boxed links; true: colored links
     linkcolor=optiplum, % color of internal links
     citecolor=optiplum, % color of links to bibliography
     filecolor=optiplum, % color of file links
     urlcolor=optiplum   % color of external links
}

%----------------------------------

% PDF settings
\hypersetup{
     bookmarks=true,         % show bookmarks bar?
     unicode=false,          % non-Latin characters in Acrobat’s bookmarks
     pdftoolbar=true,        % show Acrobat’s toolbar?
     pdfmenubar=true,        % show Acrobat’s menu?
     pdffitwindow=true,     % window fit to page when opened
     pdfstartview={FitV},    % fits the width of the page to the window
}

%----------------------------------

% Fonts
\usepackage[T1]{fontenc}	 % For correct hyphenation and T1 encoding
\usepackage{lmodern} % Default font: latin modern font
%\usepackage{fourier} % Alternative font: utopia
%\usepackage{charter} % Alternative font: low-resolution roman font
\renewcommand{\familydefault}{\sfdefault} % Sans serif - this may need to be commented to see the alternative fonts

%----------------------------------

% Various required packages
\usepackage{amsthm} % Required for theorem environments
\usepackage{bm} % Required for bold math symbols (used in the footer of the slides)
\usepackage{graphicx} % Required for including images in figures
\usepackage{tikz} % Required for colored boxes
\usepackage{booktabs} % Required for horizontal rules in tables
\usepackage{multicol} % Required for creating multiple columns in slides
\usepackage{lastpage} % For printing the total number of pages at the bottom of each slide
\usepackage[english]{babel} % Document language - required for customizing section titles
\usepackage{microtype} % Better typography
\usepackage{tocstyle} % Required for customizing the table of contents

%----------------------------------

% Slide layout configuration
\usepackage{scrpage2} % Required for customization of the header and footer
\pagestyle{scrheadings} % Activates the pagestyle from scrpage2 for custom headers and footers
\clearscrheadfoot % Remove the default header and footer
\setkomafont{pageheadfoot}{\normalfont\color{black}\sffamily} % Font settings for the header and footer

%----------------------------------

% Header configuration
\ihead{
\hspace{-2mm}
\begin{tikzpicture}[remember picture,overlay]
\node [xshift=\paperwidth/2,yshift=-\headheight] (mybar) at (current page.north west)[rectangle,fill,inner sep=0pt,minimum width=\paperwidth,minimum height=2\headheight,top color=optiplum!64,bottom color=optiplum]{}; % Colored bar
% \node[below of=mybar,yshift=3.3mm,rectangle,shade,inner sep=0pt,minimum width=128mm,minimum height =1.5mm,top color=black!50,bottom color=white]{}; 
\end{tikzpicture}
\color{white}\runninghead} % Header text defined by the \runninghead command below and colored white for contrast

%----------------------------------

% Footer configuration
\newlength{\footheight}
\setlength{\footheight}{20mm} % Height of the footer
\addtokomafont{pagefoot}{\footnotesize} % Small font size for the footnote

\ifoot{% Left side
\hspace{-2mm}
\begin{tikzpicture}[remember picture,overlay]
\node [xshift=\paperwidth/2,yshift=\footheight] at (current page.south west)[rectangle,fill,inner sep=0pt,minimum width=\paperwidth,minimum height=3pt,top color=optiplum,bottom color=optiplum]{}; % Green bar
\end{tikzpicture}
\myauthor\ \raisebox{0.2mm}{$\bm{\vert}$}\ \mycomp % Left side text
}

\ofoot[\pagemark/\pageref{LastPage}\hspace{-2mm}]{\pagemark/\pageref{LastPage}\hspace{-2mm}} % Right side

%----------------------------------

% Section spacing
\usepackage{titlesec} % Required for customizing section spacing
\titlespacing{\section}{0mm}{0mm}{0mm} % Lengths are: left, before, after
\titlespacing{\subsection}{0mm}{0mm}{-1mm} % Lengths are: left, before, after
\titlespacing{\subsubsection}{0mm}{0mm}{-1mm} % Lengths are: left, before, after
%\setcounter{secnumdepth}{0} % How deep sections are numbered, set to no numbering by default - change to 1 for numbering sections, 2 for numbering sections and subsections, etc
\setcounter{tocdepth}{2}

%----------------------------------

% Headers and footers setup
\newcommand*{\optititle}{% Title slide - you may have to tweak a few of the numbers if you wish to make changes to the layout
\thispagestyle{empty} % No slide header and footer
\begin{tikzpicture}[remember picture,overlay] % Background box
\node [xshift=\paperwidth/2,yshift=\paperheight/2] at (current page.south west)[rectangle,fill,inner sep=0pt,minimum width=\paperwidth,minimum height=\paperheight/3,top color=optiplum,bottom color=optiplum]{}; % Change the height of the box, its colors and position on the page here
\end{tikzpicture}
% Text within the box
\begin{flushright}
\vspace{1cm}
\bfseries\Large\mytitle\par % Title
\vspace{1cm}
\normalsize
\myauthor\par % Author name
\mydate\par % Date
\vfill
\end{flushright}
\clearpage
}

\newcommand*{\opticontents}{
\setcounter{page}{0}
\tableofcontents % Change the font size and print the table of contents - it may be useful to shrink the font size further if the presentation is full of sections
% To exclude sections/subsections from the table of contents, put an asterisk after \(sub)section like so: \section*{Section Name}

\clearpage
\setcounter{page}{1}
}

%----------------------------------
%----------------------------------
% End of style setup
%----------------------------------
%----------------------------------